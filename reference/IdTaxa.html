<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Assign Sequences a Taxonomic Classification — IdTaxa • CompGenomicsBioc2022</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Assign Sequences a Taxonomic Classification — IdTaxa"><meta property="og:description" content="Classifies sequences according to a training set by assigning a confidence to taxonomic labels for each taxonomic level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CompGenomicsBioc2022</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/workshop_syllabus.html">Comparative Genomics with SynExtend and DECIPHER</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ahl27/CompGenomicsBioc2022" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assign Sequences a Taxonomic Classification</h1>
    
    <div class="hidden name"><code>IdTaxa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Classifies sequences according to a training set by assigning a confidence to taxonomic labels for each taxonomic level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">IdTaxa</span><span class="op">(</span><span class="va">test</span>,
       <span class="va">trainingSet</span>,
       type <span class="op">=</span> <span class="st">"extended"</span>,
       strand <span class="op">=</span> <span class="st">"both"</span>,
       threshold <span class="op">=</span> <span class="fl">60</span>,
       bootstraps <span class="op">=</span> <span class="fl">100</span>,
       samples <span class="op">=</span> <span class="va">L</span><span class="op">^</span><span class="fl">0.47</span>,
       minDescend <span class="op">=</span> <span class="fl">0.98</span>,
       fullLength <span class="op">=</span> <span class="fl">0</span>,
       processors <span class="op">=</span> <span class="fl">1</span>,
       verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>test</dt>
<dd><p>An <code>AAStringSet</code>, <code>DNAStringSet</code>, or <code>RNAStringSet</code> of unaligned sequences.</p></dd>
<dt>trainingSet</dt>
<dd><p>An object of class <code>Taxa</code> and subclass Train.</p></dd>
<dt>type</dt>
<dd><p>Character string indicating the type of output desired.  This should be (an abbreviation of) one of <code>"extended"</code> or <code>"collapsed"</code>.  (See value section below.)</p></dd>
<dt>strand</dt>
<dd><p>Character string indicating the orientation of the <code>test</code> sequences relative to the <code>trainingSet</code>.  This should be (an abbreviation of) one of <code>"both"</code>, <code>"top"</code>, or <code>"bottom"</code>.  The top strand is defined as the input <code>test</code> sequences being in the same orientation as the <code>trainingSet</code>, and the bottom strand is its reverse complement orientation.  The default of <code>"both"</code> will classify using both orientations and choose the result with highest confidence.  Choosing the correct <code>strand</code> will make classification over 2-fold faster, assuming that all of the reads are in the same orientation. Note that <code>strand</code> is ignored when <code>test</code> is an <code>AAStringSet</code>.</p></dd>
<dt>threshold</dt>
<dd><p>Numeric specifying the confidence at which to truncate the output taxonomic classifications.  Lower values of <code>threshold</code> will classify deeper into the taxonomic tree at the expense of accuracy, and vise-versa for higher values of <code>threshold</code>.</p></dd>
<dt>bootstraps</dt>
<dd><p>Integer giving the maximum number of bootstrap replicates to perform for each sequence.  The number of bootstrap replicates is set automatically such that (on average) 99% of k-mers are sampled in each <code>test</code> sequence.</p></dd>
<dt>samples</dt>
<dd><p>A function or call written as a function of `L', which will evaluate to a numeric vector the same length as `L'.  Typically of the form ``<code>A + B*L^C</code>'', where `A', `B', and `C' are constants.</p></dd>
<dt>minDescend</dt>
<dd><p>Numeric giving the minimum fraction of <code>bootstraps</code> required to descend the tree during the initial tree descend phase of the algorithm.  Higher values are less likely to descend the tree, causing direct comparison against more sequences in the <code>trainingSet</code>.  Lower values may increase classification speed at the expense of accuracy.  Suggested values are between <code>1.0</code> and <code>0.9</code>.</p></dd>
<dt>fullLength</dt>
<dd><p>Numeric specifying the fold-difference in sequence lengths between sequences in <code>test</code> and <code>trainingSet</code> that is allowable, or <code>0</code> (the default) to consider all sequences in <code>trainingSet</code> regardless of length.  Can be specified as either a single numeric (&gt; 1), or two numerics specifying the upper and lower fold-difference.  If <code>fullLength</code> is between <code>0</code> and <code>1</code> (exclusive), the fold-difference is inferred from the length variability among sequences belonging to each class based on the <code>foldDifference</code> quantiles.  For example, setting <code>fullLength</code> to <code>0.99</code> would use the 1st and 99th percentile of intra-group length variability from the <code>trainingSet</code>.  In the case of full-length sequences, specifying <code>fullLength</code> can improve both speed and accuracy by using sequence length as a pre-filter to classification.  Note that <code>fullLength</code> should only be greater than <code>0</code> when both the <code>test</code> and <code>trainingSet</code> consist of full-length sequences.</p></dd>
<dt>processors</dt>
<dd><p>The number of processors to use, or <code>NULL</code> to automatically detect and use all available processors.</p></dd>
<dt>verbose</dt>
<dd><p>Logical indicating whether to display progress.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Sequences in <code>test</code> are each assigned a taxonomic classification based on the <code>trainingSet</code> created with <code><a href="LearnTaxa.html">LearnTaxa</a></code>.  Each taxonomic level is given a confidence between 0% and 100%, and the taxonomy is truncated where confidence drops below <code>threshold</code>.  If the taxonomic classification was truncated, the last group is labeled with ``unclassified_'' followed by the final taxon's name.  Note that the reported confidence is not a p-value but does directly relate to a given classification's probability of being wrong.  The default <code>threshold</code> of <code>60%</code> is intended to minimize the rate of incorrect classifications.  Lower values of <code>threshold</code> (e.g., <code>50%</code>) may be preferred to increase the taxonomic depth of classifications.  Values of <code>60%</code> or <code>50%</code> are recommended for nucleotide sequences and <code>50%</code> or <code>40%</code> for amino acid sequences.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>type</code> is <code>"extended"</code> (the default) then an object of class <code>Taxa</code> and subclass Train is returned.  This is stored as a list with elements corresponding to their respective sequence in <code>test</code>.  Each list element contains components:</p>
<dl><dt>taxon</dt>
<dd><p>A character vector containing the taxa to which the sequence was assigned.</p></dd>
<dt>confidence</dt>
<dd><p>A numeric vector giving the corresponding percent confidence for each taxon.</p></dd>
<dt>rank</dt>
<dd><p>If the classifier was trained with a set of <code>rank</code>s, a character vector containing the rank name of each taxon.</p></dd>
</dl><p>If <code>type</code> is <code>"collapsed"</code> then a character vector is returned with the taxonomic assignment for each sequence.  This takes the repeating form ``Taxon name [rank, confidence%]; ...'' if <code>rank</code>s were supplied during training, or ``Taxon name [confidence%]; ...'' otherwise.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Murali, A., et al. (2018). IDTAXA: a novel approach for accurate taxonomic classification of microbiome sequences. Microbiome, 6, 140. https://doi.org/10.1186/s40168-018-0521-5</p>
<p>Cooley, N. and Wright, E. (2021). Accurate annotation of protein coding sequences with IDTAXA. NAR Genomics and Bioinformatics, <b>3(3)</b>. https://doi.org/10.1093/nargab/lqab080</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Erik Wright <a href="mailto:eswright@pitt.edu">eswright@pitt.edu</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="LearnTaxa.html">LearnTaxa</a></code>, <code><a href="Taxa-class.html">Taxa-class</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TrainingSet_16S"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># import test sequences</span></span>
<span class="r-in"><span class="va">fas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Bacteria_175seqs.fas"</span>, package<span class="op">=</span><span class="st">"DECIPHER"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dna</span> <span class="op">&lt;-</span> <span class="fu">readDNAStringSet</span><span class="op">(</span><span class="va">fas</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># remove any gaps in the sequences</span></span>
<span class="r-in"><span class="va">dna</span> <span class="op">&lt;-</span> <span class="fu">RemoveGaps</span><span class="op">(</span><span class="va">dna</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># classify the test sequences</span></span>
<span class="r-in"><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu">IdTaxa</span><span class="op">(</span><span class="va">dna</span>, <span class="va">TrainingSet_16S</span>, strand<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time difference of 7.55 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">ids</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A test set of class 'Taxa' with length 175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       confidence name                 taxon</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]        75% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [2]        68% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [3]        65% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; Ba...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [4]        92% uncultured bacter... Root; Bacteria; Firmicutes; Bacilli; La...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [5]        61% uncultured bacter... Root; Bacteria; Firmicutes; Clostridia;...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ...        ... ...                  ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [171]        38% uncultured bacter... Root; unclassified_Root                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [172]        48% uncultured bacter... Root; unclassified_Root                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [173]        31% uncultured bacter... Root; unclassified_Root                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [174]        50% uncultured bacter... Root; unclassified_Root                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [175]        54% uncultured bacter... Root; unclassified_Root                   </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># view the results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ids</span>, <span class="va">TrainingSet_16S</span><span class="op">)</span></span>
<span class="r-plt img"><img src="IdTaxa-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Aidan Lakshman.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

